{
  "waf_rules": [
    {
      "name": "Rate Limiting - Login Attempts",
      "description": "Limit login attempts to prevent brute force attacks",
      "rule": {
        "expression": "(http.request.uri.path contains \"/auth/login\" or http.request.uri.path contains \"/api/auth/login\") and (rate(5m) > 10)",
        "action": "block",
        "characteristics": ["ip.src"]
      }
    },
    {
      "name": "Rate Limiting - API Calls",
      "description": "General API rate limiting",
      "rule": {
        "expression": "http.request.uri.path contains \"/api/\" and (rate(1m) > 60)",
        "action": "challenge",
        "characteristics": ["ip.src"]
      }
    },
    {
      "name": "Rate Limiting - Payment Endpoints",
      "description": "Strict rate limiting for payment operations",
      "rule": {
        "expression": "(http.request.uri.path contains \"/api/payments\" or http.request.uri.path contains \"/api/withdrawals\") and (rate(5m) > 5)",
        "action": "block",
        "characteristics": ["ip.src"]
      }
    },
    {
      "name": "Bot Protection",
      "description": "Block known bad bots and scrapers",
      "rule": {
        "expression": "(cf.client.bot) and not (cf.verified_bot_category in {\"Search Engine\" \"Social Media\"})",
        "action": "block"
      }
    },
    {
      "name": "Geo Blocking",
      "description": "Block traffic from restricted countries",
      "rule": {
        "expression": "ip.geoip.country in {\"US\" \"GB\" \"FR\"}",
        "action": "block"
      }
    },
    {
      "name": "SQL Injection Protection",
      "description": "Block common SQL injection patterns",
      "rule": {
        "expression": "http.request.body contains \"union select\" or http.request.body contains \"drop table\" or http.request.uri.query contains \"' or '1'='1\"",
        "action": "block"
      }
    },
    {
      "name": "XSS Protection",
      "description": "Block cross-site scripting attempts",
      "rule": {
        "expression": "http.request.body contains \"<script\" or http.request.uri.query contains \"javascript:\" or http.request.headers[\"referer\"] contains \"<script\"",
        "action": "block"
      }
    }
  ],
  "cache_rules": [
    {
      "name": "Static Assets Cache",
      "description": "Cache static assets for optimal performance",
      "rule": {
        "expression": "http.request.uri.path matches \"\\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$\"",
        "cache_level": "cache_everything",
        "edge_cache_ttl": 31536000,
        "browser_cache_ttl": 86400
      }
    },
    {
      "name": "API Response Cache",
      "description": "Cache certain API responses",
      "rule": {
        "expression": "http.request.uri.path contains \"/api/games\" or http.request.uri.path contains \"/api/providers\"",
        "cache_level": "cache_everything",
        "edge_cache_ttl": 300,
        "browser_cache_ttl": 60
      }
    }
  ]
}